<html>
<head>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<link rel="stylesheet" href="../../dijit/themes/claro/claro.css"/>

<script src="https://www.google.com/jsapi?key=ABQIAAAA-DMAtggvLwlIYlUJiASaAxRQnCpeV9jusWIeBw0POFqU6SItGxRWZhddpS8pIkVUd2fDQhzwPUWmMA"></script>
<script src="http://api-maps.yandex.ru/1.1/index.xml?key=AMOPgE4BAAAA9Y-BUwMAonjZ5NBRJDj54c-cDVPzQcYlLNAAAAAAAAAAAACPSuKS9WyCiMuXm9An1ZKCx5Pk-A=="></script>

<script>
    dojoConfig = {
        isDebug: true,
		parseOnLoad: false,
        modulePaths: {djeo: "../djeo"},
		djeoEngine: "gfx"
    };
</script>
<script src="../tests/util.js"></script>
<script src="../../dojo/dojo.js"></script>

<script>
if (dojo.config.djeoEngine=="ge") dojo.require("djeo.ge.Engine");

dojo.require("dijit.form.Button");
DebugUtil.timer.start("loading");
dojo.require("djeo.Map");

dojo.require("djeo.control.Highlight");
dojo.require("djeo.control.Tooltip");
dojo.require("djeo.control.Navigation");

dojo.require("djeo.demo.data.berlin_buildings");
dojo.require("djeo.demo.data.berlin_lines");


dojo.require("djeo.util.proj4js");
dojo.require("djeo.util.proj4js.merc");
dojo.require("djeo.projection");


var map, magnify, highlight, tooltip;

var style = [
	{
		styleClass: "buildings",
		fill: "#bca9a9",
		strokeWidth: 0.001
	},
	{
		styleClass: "lines",
		stroke: "#bbb",
		strokeWidth: 1
	},
	{
		styleClass: "lines",
		filter: "this.highway=='primary'",
		stroke: "#8d4346",
		strokeWidth: 3
	},
	{
		styleClass: "lines",
		filter: "this.highway=='secondary'",
		stroke: "#a37b48",
		strokeWidth: 2.5
	},
	{
		styleClass: "lines",
		filter: "this.highway=='tertiary'",
		stroke: "#ffffb3",
		strokeWidth: 1.8
	},
	{
		styleClass: "lines",
		filter: "this.railway",
		stroke: "#000",
		strokeWidth: 0.5
	}
]

var features = [
	{
		styleClass: "buildings",
		features: djeo.demo.data.berlin_buildings
	},
	{
		styleClass: "lines",
		features: djeo.demo.data.berlin_lines
	}
];

DebugUtil.timer.end("loading");

var highlight, tooltip;
var addOnLoad = function() {
    new dijit.form.ToggleButton({
		checked: true,
		onChange: function(value){
			if (value) highlight.enable();
			else highlight.disable();
		},
		iconClass: "dijitRadioIcon"
	}, "highlight");
    new dijit.form.ToggleButton({
		checked: true,
		onChange: function(value){
			if (value) tooltip.enable();
			else tooltip.disable();
		},
		iconClass: "dijitRadioIcon"
	}, "tooltip");

	DebugUtil.timer.start("render");
    map = new djeo.Map("map", {
		coordsProjection: "EPSG:4326",
		projection: "EPSG:3785",
		style: style,
		features: features
	});
	map.ready(function(){
		DebugUtil.timer.end("render");
		DebugUtil.timer.start("events-init");
		new djeo.control.Navigation(map, {resizeLines: false});
		highlight = new djeo.control.Highlight(map);
		tooltip = new djeo.control.Tooltip(map);
		DebugUtil.timer.end("events-init");
	});
}



dojo.addOnLoad(addOnLoad);

</script>

</head>

<body class="claro">

<div id="highlight">Highlight</div>
<div id="tooltip">Tooltip</div>
<div id="map" style="width:600px;height:600px;"></div>
Map data (c) <a href="http://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>.
</body>
</html>